before_install:
  - pwd
  - ls -lah
  - sudo apt-get -qq update
  - |
    sudo apt-get install -y gcc \
      flex \
      bison \
      libssl-dev \
      libdb-dev \
      linux-source \
      perl \
      make \
      autoconf \
      linux-headers-$(uname -r) \
      zip \
      openssl \
      automake \
      autoconf \
      patch \
      g++
  - wget http://www.orangefs.org/downloads/LATEST/source/orangefs-2.9.3.tar.gz
  - tar -xzf orangefs-2.9.3.tar.gz
  - |
    cd orangefs-2.9.3 && \
    ./configure \
      --prefix=/opt/orangefs \
      --enable-shared \
      --with-kernel=/lib/modules/$(uname -r)/build && \
    make -j$(nproc) && \
    make kmod && \
    sudo make install && \
    sudo make kmod_prefix=/opt/orangefs kmod_install && \
    cd -
  - pwd
  - ls -lah

before_script:
  - ls -lahR /opt/orangefs

script: make && sudo make install
